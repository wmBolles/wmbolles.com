var er=Object.defineProperty;var or=(t,e,o)=>e in t?er(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var Z=(t,e,o)=>(or(t,typeof e!="symbol"?e+"":e,o),o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))r(d);new MutationObserver(d=>{for(const c of d)if(c.type==="childList")for(const g of c.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&r(g)}).observe(document,{childList:!0,subtree:!0});function o(d){const c={};return d.integrity&&(c.integrity=d.integrity),d.referrerPolicy&&(c.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?c.credentials="include":d.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(d){if(d.ep)return;d.ep=!0;const c=o(d);fetch(d.href,c)}})();const Do=document.getElementById("loadingScreen"),Ee=document.getElementById("loadingScreenClickText"),me=t=>{Ee.textContent=t},Ot=()=>{Do.classList.add("hide")},po=()=>{Do.classList.remove("hide")},fe=()=>{Ee.classList.remove("hide")},nr=()=>{Ee.classList.add("hide")},sr="data:audio/mpeg;base64,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";class Me{constructor(e){Z(this,"source");Z(this,"isPlaying");this.source=new Audio,this.source.src=e,this.isPlaying=!1}play(){throw'method "play" must be implemented'}pause(){throw'method "pause" must be implemented'}stop(){throw'method "stop" must be implemented'}loop(e){throw'method "loop" must be implemented'}}class rr extends Me{constructor(o){super(o);Z(this,"channel");this.channel=this.source}play(){this.isPlaying=!0,this.channel.play(),this.channel.onended=()=>{this.isPlaying=!1}}pause(){this.isPlaying=!1,this.channel.pause()}stop(){this.pause(),this.channel.currentTime=0}loop(o){this.channel.loop=o}}class ar extends Me{constructor(o){super(o);Z(this,"channels");this.channels=new Set}checkTrackPaused(){return this.isPlaying}checkChannelsExist(){return this.channels.size>0}resume(){[...this.channels.values()].forEach(o=>{o.play()}),this.isPlaying=!0}playNewChannel(){const o=new Audio;o.src=this.source.src,this.channels.add(o),o.onended=()=>{this.channels.delete(o),this.channels.size===0&&(this.isPlaying=!1)},this.isPlaying=!0,o.play()}play(){!this.checkTrackPaused()&&this.checkChannelsExist()?this.resume():this.playNewChannel()}pause(){this.isPlaying=!1,[...this.channels.values()].forEach(o=>{o.pause()})}stop(){this.isPlaying=!1,[...this.channels.values()].forEach(o=>{o.pause(),this.channels.delete(o)})}}class Qo{constructor(){Z(this,"audios");this.audios=new Map,this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stop=this.stop.bind(this)}getTrackExist(e){return this.audios.has(e)}checkTrackExist(e){if(!this.getTrackExist(e))throw`track - ${e} doesn't exist`;return!0}checksBeforePlay(e){return this.checkTrackExist(e)}checkTrackDuplicate(e){if(this.getTrackExist(e))throw`track - ${e} already exist`}createTrack(e){return new Me(e)}addTrack(e,o){this.audios.set(e,o)}add(e,o,r){this.checkTrackDuplicate(e);const d=this.createTrack(o);this.addTrack(e,d)}play(e){if(!this.checksBeforePlay(e))return;const o=this.audios.get(e);return o.play(),o}loop(e,o){this.audios.get(e).loop(o)}pause(e){const o=this.audios.get(e);return o.pause(),o}stop(e){const o=this.audios.get(e);return o.stop(),o}vol(e,o=1){const r=this.audios.get(e);r.source.volume=o}}class ir extends Qo{createTrack(e){return new rr(e)}checkTrackAlreadyPlaying(e){return this.audios.get(e).isPlaying}checksBeforePlay(e){return super.checksBeforePlay(e)&&!this.checkTrackAlreadyPlaying(e)}}class cr extends Qo{createTrack(e){return new ar(e)}}const ut=new cr;ut.add("menuButtonHover",sr);const lr=""+new URL("wall_btn_press-88453b56.mp3",import.meta.url).href,Ar=""+new URL("wall_btn_unpress-a8f1d7d9.mp3",import.meta.url).href,dr=""+new URL("wallOpen-6cf2272c.mp3",import.meta.url).href,qr=""+new URL("lvlBg1-7085f06f.mp3",import.meta.url).href,ur=""+new URL("lvlBg2-2ece8d06.mp3",import.meta.url).href,pr=""+new URL("lvlBg3-92d578d2.mp3",import.meta.url).href,hr=""+new URL("lvlBg4-9237c997.mp3",import.meta.url).href,mr="data:audio/mpeg;base64,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",fr=""+new URL("pickingSword-ad897c7e.mp3",import.meta.url).href,yr="data:audio/mpeg;base64,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",vr=""+new URL("torch1-8dd79653.mp3",import.meta.url).href,gr=""+new URL("bugSound1-3949f28e.mp3",import.meta.url).href,wr=""+new URL("portalRoomSound-969c769e.mp3",import.meta.url).href,Sr=""+new URL("scrollOpen-4031edff.mp3",import.meta.url).href,xr=""+new URL("closeScroll-39d7e076.mp3",import.meta.url).href,br=""+new URL("pickingSpell-8b8a6f94.mp3",import.meta.url).href,Br=""+new URL("transformSpell-94005411.mp3",import.meta.url).href,kr=""+new URL("healSpell-c3b92eef.mp3",import.meta.url).href,Cr=""+new URL("notEnoughMana-21d0e1d2.mp3",import.meta.url).href,Er=""+new URL("awakening-e912cded.mp3",import.meta.url).href,Mr=""+new URL("lvlEnd-37ef2b3c.mp3",import.meta.url).href,Lr="data:audio/mpeg;base64,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",Pr=""+new URL("menuBg-5b597f27.mp3",import.meta.url).href,Ir=""+new URL("glassWallSound-d474d607.mp3",import.meta.url).href,Xr=""+new URL("taskDoneOST-e08a9bab.mp3",import.meta.url).href,h=new ir;h.add("wall_btn_press",lr);h.add("wall_btn_unpress",Ar);h.add("wall_opening",dr);h.add("lvlBg1",qr);h.add("lvlBg2",ur);h.add("lvlBg3",pr);h.add("lvlBg4",hr);h.add("playerSteps1",mr);h.add("pickingSword",fr);h.add("swordAttack",yr);h.add("torch1",vr);h.add("bugSound1",gr);h.add("portalRoomSound",wr);h.add("scrollRead",Sr);h.add("scrollClose",xr);h.add("pickingSpell",br);h.add("transformSpell",Br);h.add("healSpell",kr);h.add("notEnoughMana",Cr);h.add("awakeningOST",Er);h.add("lvlEnd",Mr);h.add("menuButtonClick",Lr);h.add("menuBg",Pr);h.add("glassWallSound",Ir);h.add("taskDone",Xr);let ho,wt=document.getElementById("fpsTourWrap").getElementsByClassName("fpsTourValue")[0],ye,ie=null,Zt,Wo,Le;const Yr=()=>{Fo(Zt),Tr()},Tr=()=>{Zt<30?wt.style.color="red":Zt<45?wt.style.color="orange":wt.style.color="lime"},Rr=()=>{wt.style.color="white"},Fo=t=>{wt.textContent=String(t)},Or=()=>{ie=performance.now(),Zt=Math.floor(1e3/(ie-ye)),ye=ie},No=()=>{Or(),Le=requestAnimationFrame(No)},Zr=(t=0)=>{ye=performance.now(),ho=t,Le=requestAnimationFrame(No),Wo=setInterval(Yr,ho)},Ur=()=>{clearInterval(Wo),cancelAnimationFrame(Le),Fo(0),Rr()},Go=document.getElementById("fpsTourWrap"),Dr=document.getElementById("camera");let ve;const Qr=()=>(Go.classList.remove("hide"),Zr(1e3),ve=Dr.animate([{transform:"rotateX(0deg) rotateY(90deg) translateX(400px) translateZ(-135px)"},{transform:"rotateX(0deg) rotateY(125deg) translateX(-720px) translateZ(-135px)"},{transform:"rotateX(0deg) rotateY(165deg) translateX(-720px) translateZ(-135px)"},{transform:"rotateX(0deg) rotateY(6deg) translateX(-910px) translateZ(793px)"},{transform:"rotateX(11deg) rotateY(10deg) translateX(-800px) translateZ(593px)"},{transform:"rotateX(14deg) rotateY(-45deg) translateX(-965px) translateZ(680px)"},{transform:"rotateX(-3deg) rotateY(-180deg) translateX(-965px) translateZ(300px)"},{transform:"rotateX(-3deg) rotateY(-180deg) translateX(-965px) translateZ(100px)"}],{duration:35e3}),ve),Wr=()=>{Go.classList.add("hide"),ve.cancel(),Ur()},Fr=document.getElementById("UISection"),Nr=()=>{Fr.classList.remove("hide")};let Vo=0,zo=0,Ko=0,Ho=0,jo=0,Jo=0,_o=0;const at=()=>Vo,it=()=>zo,$o=()=>Ko,pt=t=>{Vo=t},ht=t=>{zo=t},Pe=t=>{Ko=t},tn=()=>Ho,en=()=>jo,Gr=()=>Jo,on=()=>_o,Vr=t=>{Ho=t},zr=t=>{jo=t},Kr=t=>{Jo=t},Hr=t=>{_o=t};let nn=0,sn=0,rn=0;const jr=({x:t,y:e,z:o})=>{nn=t,sn=e,rn=o},Ie=()=>at()-nn,Jr=()=>$o()-sn,Xe=()=>it()-rn;class V{constructor(){Z(this,"subscribers");this.subscribers=[]}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(o=>o!==e)}broadcast(e){this.subscribers.forEach(o=>o(e))}}const _r=15;let an=15,cn=15,ln=0,An=1,dn=0,qn=1,un=0,pn=0;const hn=()=>_r,D=()=>({stepSizeX:an,stepSizeZ:cn}),mo=()=>({forwardStepCoefX:ln,forwardStepCoefZ:An}),fo=()=>({backwardStepCoefX:dn,backwardStepCoefZ:qn}),Ut=()=>({sideStepCoefX:un,sideStepCoefZ:pn}),Ht=t=>{an=t},jt=t=>{cn=t},$r=t=>{ln=t},ta=t=>{An=t},ea=t=>{dn=t},oa=t=>{qn=t},na=t=>{un=t},sa=t=>{pn=t};class mn extends V{constructor(o){super();Z(this,"movementId");Z(this,"direction");Z(this,"curMoveCallback");Z(this,"directionHandlers");Z(this,"move",()=>{this.movementId=requestAnimationFrame(this.move),this.curMoveCallback()});this.movementId=null,this.direction=null,this.curMoveCallback=null,this.directionHandlers=o}initMove(o){this.direction=o,this.curMoveCallback=this.directionHandlers[this.direction],this.movementId=requestAnimationFrame(this.move)}stopMove(){this.broadcast({state:!1,direction:this.direction}),this.direction=null,cancelAnimationFrame(this.movementId)}startMove(o){this.direction!==o&&(this.stopMove(),this.initMove(o),this.broadcast({state:!0,direction:o}))}}const ra=()=>{ht(it()+D().stepSizeZ*mo().forwardStepCoefZ|0),pt(at()+D().stepSizeX*mo().forwardStepCoefX|0)},aa=()=>{ht(it()+D().stepSizeZ*fo().backwardStepCoefZ|0),pt(at()+D().stepSizeX*fo().backwardStepCoefX|0)},ia={forward:ra,backward:aa},et=new mn(ia);class Jt extends V{constructor({direction:o,keyCode:r,initMoveCallback:d,stopMoveCallback:c}){super();Z(this,"direction");Z(this,"isMoving");Z(this,"keyCode");Z(this,"initMoveCallback");Z(this,"stopMoveCallback");Z(this,"onKeyPress",({code:o})=>{o===this.keyCode&&(this.isMoving||(this.isMoving=!0,this.initMoveCallback(),this.broadcast({direction:this.direction,stateValue:this.isMoving})))});Z(this,"onKeyUp",({code:o})=>{o===this.keyCode&&(this.isMoving=!1,this.stopMoveCallback(),this.broadcast({direction:this.direction,stateValue:this.isMoving}))});this.direction=o,this.isMoving=!1,this.keyCode=r,this.initMoveCallback=d,this.stopMoveCallback=c}enable(){window.addEventListener("keydown",this.onKeyPress),window.addEventListener("keyup",this.onKeyUp)}stop(){this.isMoving=!1,this.stopMoveCallback()}disable(){window.removeEventListener("keydown",this.onKeyPress),window.removeEventListener("keyup",this.onKeyUp)}}const Dt=new Jt({direction:"forward",keyCode:"KeyW",initMoveCallback:()=>{et.startMove("forward")},stopMoveCallback:()=>{et.stopMove()}}),Qt=new Jt({direction:"backward",keyCode:"KeyS",initMoveCallback:()=>{et.startMove("backward")},stopMoveCallback:()=>{et.stopMove()}}),ca=()=>{pt(at()+D().stepSizeX*Ut().sideStepCoefX|0),ht(it()+D().stepSizeZ*Ut().sideStepCoefZ|0)},la=()=>{pt(at()-D().stepSizeX*Ut().sideStepCoefX|0),ht(it()-D().stepSizeZ*Ut().sideStepCoefZ|0)},Aa={right:ca,left:la},ot=new mn(Aa),Wt=new Jt({direction:"right",keyCode:"KeyD",initMoveCallback:()=>{ot.startMove("right")},stopMoveCallback:()=>{ot.stopMove()}}),Ft=new Jt({direction:"left",keyCode:"KeyA",initMoveCallback:()=>{ot.startMove("left")},stopMoveCallback:()=>{ot.stopMove()}}),ge={forward:!1,backward:!1,right:!1,left:!1};let fn=!1;const da=()=>{fn=Object.values(ge).includes(!0)},kt=new V,_t=({direction:t,stateValue:e})=>{ge[t]=e,da(),kt.broadcast({...ge,changed:t,isMoving:fn})};Dt.subscribe(_t);Qt.subscribe(_t);Wt.subscribe(_t);Ft.subscribe(_t);const Ct=new Map,F=(t,e)=>{Ct.set(t,e)},nt=t=>{Ct.delete(t)},yn=t=>{const e=Ct.get(t);if(!e)throw`unknown item - ${t}`;e.isActive=!1},qa=()=>Ct.entries(),ua=()=>{Ct.forEach(t=>{t.deactivationCallback(),t.isActive=!1})};let ce=!1;const $t=()=>{const t=qa();let e;for(let[o,r]of t)if(e=pa(r),e){if(r.isActive)continue;r.isActive=!0,r.activationCallback()}else r.isActive&&(r.isActive=!1,r.deactivationCallback())},pa=t=>{const e=Ie(),o=Xe();return e>=t.minX&&e<=t.maxX&&o>=t.minZ&&o<=t.maxZ};let Ye;const vn=()=>{Ye=requestAnimationFrame(vn),$t()},ha=()=>{Ye=requestAnimationFrame(vn)},gn=()=>{cancelAnimationFrame(Ye)},wn=({isMoving:t})=>{if(t){if(ce)return;ha(),ce=!0}else gn(),ce=!1},Sn=()=>{kt.subscribe(wn)},ma=()=>{kt.unsubscribe(wn)},xn=document.getElementById("hpBar");let St=0;const bn=()=>{xn.animate([{opacity:.5},{opacity:1},{opacity:.5}],{duration:500})},fa=t=>{St=t,bn(),Bn()},ya=t=>{St+=t,St>100&&(St=100),bn(),Bn()},Bn=()=>{xn.style.setProperty("--hpValue",`${St}%`)},te=document.getElementById("subPanelsSection"),Te={controlsSection:document.getElementById("controlsSection"),aboutSection:document.getElementById("aboutSection")};let Nt=null;const va=()=>{te.classList.remove("hide")},ga=()=>{te.classList.add("hide")},wa=t=>{const e=Te[t];if(!e)throw`unknown sub panel - ${t}`;e.classList.remove("hide"),Nt=t},Sa=t=>{const e=Te[t];if(!e)throw`unknown sub panel - ${t}`;e.classList.add("hide"),Nt=t},Gt=t=>{wa(t),va()},kn=t=>{Sa(t),ga()},xa=({target:t})=>{t.classList.contains("subPanelsSection_closeButton")&&(kn(Nt),Nt=null,h.play("menuButtonClick"))};te.addEventListener("click",xa);const ba=({target:t})=>{t.classList.contains("subPanelsSection_closeButton")&&ut.play("menuButtonHover")};te.addEventListener("mouseover",ba);const Re=document.getElementById("pointerLockInaccessibleIcon");let we=!1;const Ba=async()=>{we||(Ca(),await ka(),Ea())},ka=()=>{we=!0;const t=Re.animate([{transform:"scale(1)"},{transform:"scale(0.7)"},{transform:"scale(1)"}],{duration:1e3});return t.finished.then(()=>{we=!1}),t.finished},Ca=()=>{Re.classList.remove("hide")},Ea=()=>{Re.classList.add("hide")},Ma=(t,e)=>Math.random()*(e-t)+t|0;var Uo;const La=(Uo=new Array(["Microsoft Edge",/edg/i],["Microsoft Internet Explorer",/trident/i],["Mozilla Firefox",/firefox|fxios/i],["Opera",/opr\//i],["UC Browser",/ucbrowser/i],["Samsung Browser",/samsungbrowser/i],["Google Chrome",/chrome|chromium|crios/i],["Apple Safari",/safari/i],["Unknown",/.+/i]).find(([,t])=>t.test(window.navigator.userAgent)))==null?void 0:Uo.shift(),Pa=()=>La,At=new V,Cn=document.body.requestPointerLock.bind(document.body),En=()=>{document.pointerLockElement===document.body?At.broadcast(!0):At.broadcast(!1)},Ia=()=>{Cn().catch(Ba)},Xa=()=>{Cn()};let Ya=Pa()==="Google Chrome"?Ia:Xa;const Et=()=>{Ya()},Oe=()=>{document.exitPointerLock()},Ta=()=>{document.addEventListener("pointerlockchange",En),document.addEventListener("click",Et)},Ra=()=>{document.removeEventListener("pointerlockchange",En),document.removeEventListener("click",Et)},yo=document.getElementById("infoIcon"),Oa=t=>{t.stopPropagation(),h.play("menuButtonClick"),Gt("controlsSection")},Za=()=>{ut.play("menuButtonHover")},Ua=({code:t})=>{if(t==="KeyI"){if(Te.controlsSection.classList.contains("hide")){Da();return}Qa()}},Da=()=>{Oe(),h.play("menuButtonClick"),Gt("controlsSection")},Qa=()=>{Et(),h.play("menuButtonClick"),kn("controlsSection")},Wa=()=>{yo.addEventListener("mouseover",Za),yo.addEventListener("click",Oa),window.addEventListener("keydown",Ua)},Mn=document.getElementById("manaBar"),Fa=3,Na=500;let H=0,Ln=null;const Ga=t=>{H=t,Ze()},Pn=()=>{Mn.animate([{opacity:.5},{opacity:1},{opacity:.5}],{duration:500})},In=()=>H,Xn=t=>{t<=H?H-=t:H=0,Ze()},Va=t=>{H+=t,H>100&&(H=100),Ze()},Ze=()=>{Mn.style.setProperty("--manaValue",`${H}%`)},za=()=>{Ln=setInterval(Va,Na,Fa)},Ka=()=>{clearInterval(Ln)},bt=document.getElementById("movementBar");let Rt;const Yn=t=>{t&&bt.classList.remove(t),Rt=t,bt.classList.add(t)},Tn=()=>{bt.classList.remove("hide")},Rn=()=>{bt.classList.add("hide"),Rt&&(bt.classList.remove(Rt),Rt=null)},Ue=new V,Vt=hn()/1.5;let De=!0,dt=!1;const On=()=>dt,Ha=()=>{De&&(dt=!0,jt(D().stepSizeZ+Vt),Ht(D().stepSizeX+Vt),Ue.broadcast(dt),Yn("run"),Tn())},Zn=()=>{dt=!1,jt(D().stepSizeZ-Vt),Ht(D().stepSizeX-Vt),Ue.broadcast(dt),Rn()},ja=()=>{De=!1,dt&&Zn()},Ja=()=>{De=!0},Un=({code:t})=>{if(t==="ShiftLeft"){if(On())return;Ha()}},Dn=({code:t})=>{On()&&t==="ShiftLeft"&&Zn()},_a=()=>{window.addEventListener("keydown",Un),window.addEventListener("keyup",Dn)},$a=()=>{window.removeEventListener("keydown",Un),window.removeEventListener("keyup",Dn)};let ti=0,Qn=0,ei=0;const oi=()=>ti,Qe=()=>Qn,ni=()=>ei,Wn=t=>{Qn=t},Fn=150;let We=!1;const Nn=()=>We,si=()=>{We=!0,Wn(Qe()-Fn),ja(),Yn("squat"),Tn()},ri=()=>{We=!1,Wn(Qe()+Fn),Ja(),Rn()},Gn=({code:t})=>{if(t==="KeyC"){if(Nn())return;si()}},Vn=({code:t})=>{Nn()&&t==="KeyC"&&ri()},zn=()=>{window.addEventListener("keydown",Gn),window.addEventListener("keyup",Vn)},Kn=()=>{window.removeEventListener("keydown",Gn),window.removeEventListener("keyup",Vn)},st=t=>t>360?t-360:t<0?t+360:t,Fe=t=>{let e;return t<=90?e=ai(t):t<=180?e=ii(t):t<=270?e=ci(t):t<=360&&(e=li(t)),e},ai=t=>{const e=t/90*-1,o=1+e;return{x:e,z:o}},ii=t=>{const e=(t/90-1)*-1;return{x:(1+e)*-1,z:e}},ci=t=>{const e=t/90-2,o=(1-e)*-1;return{x:e,z:o}},li=t=>{const e=t/90-3;return{x:1-e,z:e}},Ne=new V,Ge=({movementX:t,movementY:e})=>{const o=t,r=e,d=tn()-o,c=en()-r,g=st(Gr()-o),C=st(on()-r);Ne.broadcast({newRealAngleX:d,newRealAngleY:c,newNormalizedAngleX:g,newNormalizedAngleY:C,movementX:t,movementY:e})},Ai=()=>{Ne.broadcast({newRealAngleX:0,newRealAngleY:0,newNormalizedAngleX:0,newNormalizedAngleY:0,movementX:1,movementY:0})},di=()=>{document.addEventListener("mousemove",Ge)},qi=()=>{document.removeEventListener("mousemove",Ge)},Mt=t=>{t?(Dt.enable(),Qt.enable(),Ft.enable(),Wt.enable(),_a(),zn(),di()):(Dt.disable(),Qt.disable(),Ft.disable(),Wt.disable(),$a(),Kn(),qi())},ui=()=>{At.subscribe(Mt)};var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ve={},j={},rt={},pi={get exports(){return rt},set exports(t){rt=t}};(function(t,e){/** @preserve SAT.js - Version 0.9.0 - Copyright 2012 - 2021 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */(function(o,r){t.exports=r()})($,function(){var o={};function r(n,l){this.x=n||0,this.y=l||0}o.Vector=r,o.V=r,r.prototype.copy=r.prototype.copy=function(n){return this.x=n.x,this.y=n.y,this},r.prototype.clone=r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.perp=r.prototype.perp=function(){var n=this.x;return this.x=this.y,this.y=-n,this},r.prototype.rotate=r.prototype.rotate=function(n){var l=this.x,a=this.y;return this.x=l*Math.cos(n)-a*Math.sin(n),this.y=l*Math.sin(n)+a*Math.cos(n),this},r.prototype.reverse=r.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},r.prototype.normalize=r.prototype.normalize=function(){var n=this.len();return n>0&&(this.x=this.x/n,this.y=this.y/n),this},r.prototype.add=r.prototype.add=function(n){return this.x+=n.x,this.y+=n.y,this},r.prototype.sub=r.prototype.sub=function(n){return this.x-=n.x,this.y-=n.y,this},r.prototype.scale=r.prototype.scale=function(n,l){return this.x*=n,this.y*=typeof l<"u"?l:n,this},r.prototype.project=r.prototype.project=function(n){var l=this.dot(n)/n.len2();return this.x=l*n.x,this.y=l*n.y,this},r.prototype.projectN=r.prototype.projectN=function(n){var l=this.dot(n);return this.x=l*n.x,this.y=l*n.y,this},r.prototype.reflect=r.prototype.reflect=function(n){var l=this.x,a=this.y;return this.project(n).scale(2),this.x-=l,this.y-=a,this},r.prototype.reflectN=r.prototype.reflectN=function(n){var l=this.x,a=this.y;return this.projectN(n).scale(2),this.x-=l,this.y-=a,this},r.prototype.dot=r.prototype.dot=function(n){return this.x*n.x+this.y*n.y},r.prototype.len2=r.prototype.len2=function(){return this.dot(this)},r.prototype.len=r.prototype.len=function(){return Math.sqrt(this.len2())};function d(n,l){this.pos=n||new r,this.r=l||0,this.offset=new r}o.Circle=d,d.prototype.getAABBAsBox=d.prototype.getAABBAsBox=function(){var n=this.r,l=this.pos.clone().add(this.offset).sub(new r(n,n));return new g(l,n*2,n*2)},d.prototype.getAABB=d.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},d.prototype.setOffset=d.prototype.setOffset=function(n){return this.offset=n,this};function c(n,l){this.pos=n||new r,this.angle=0,this.offset=new r,this.setPoints(l||[])}o.Polygon=c,c.prototype.setPoints=c.prototype.setPoints=function(n){var l=!this.points||this.points.length!==n.length;if(l){var a,p=this.calcPoints=[],u=this.edges=[],x=this.normals=[];for(a=0;a<n.length;a++){var b=n[a],q=a<n.length-1?n[a+1]:n[0];if(b!==q&&b.x===q.x&&b.y===q.y){n.splice(a,1),a-=1;continue}p.push(new r),u.push(new r),x.push(new r)}}return this.points=n,this._recalc(),this},c.prototype.setAngle=c.prototype.setAngle=function(n){return this.angle=n,this._recalc(),this},c.prototype.setOffset=c.prototype.setOffset=function(n){return this.offset=n,this._recalc(),this},c.prototype.rotate=c.prototype.rotate=function(n){for(var l=this.points,a=l.length,p=0;p<a;p++)l[p].rotate(n);return this._recalc(),this},c.prototype.translate=c.prototype.translate=function(n,l){for(var a=this.points,p=a.length,u=0;u<p;u++)a[u].x+=n,a[u].y+=l;return this._recalc(),this},c.prototype._recalc=function(){var n=this.calcPoints,l=this.edges,a=this.normals,p=this.points,u=this.offset,x=this.angle,b=p.length,q;for(q=0;q<b;q++){var M=n[q].copy(p[q]);M.x+=u.x,M.y+=u.y,x!==0&&M.rotate(x)}for(q=0;q<b;q++){var P=n[q],O=q<b-1?n[q+1]:n[0],W=l[q].copy(O).sub(P);a[q].copy(W).perp().normalize()}return this},c.prototype.getAABBAsBox=c.prototype.getAABBAsBox=function(){for(var n=this.calcPoints,l=n.length,a=n[0].x,p=n[0].y,u=n[0].x,x=n[0].y,b=1;b<l;b++){var q=n[b];q.x<a?a=q.x:q.x>u&&(u=q.x),q.y<p?p=q.y:q.y>x&&(x=q.y)}return new g(this.pos.clone().add(new r(a,p)),u-a,x-p)},c.prototype.getAABB=c.prototype.getAABB=function(){return this.getAABBAsBox().toPolygon()},c.prototype.getCentroid=c.prototype.getCentroid=function(){for(var n=this.calcPoints,l=n.length,a=0,p=0,u=0,x=0;x<l;x++){var b=n[x],q=x===l-1?n[0]:n[x+1],M=b.x*q.y-q.x*b.y;a+=(b.x+q.x)*M,p+=(b.y+q.y)*M,u+=M}return u=u*3,a=a/u,p=p/u,new r(a,p)};function g(n,l,a){this.pos=n||new r,this.w=l||0,this.h=a||0}o.Box=g,g.prototype.toPolygon=g.prototype.toPolygon=function(){var n=this.pos,l=this.w,a=this.h;return new c(new r(n.x,n.y),[new r,new r(l,0),new r(l,a),new r(0,a)])};function C(){this.a=null,this.b=null,this.overlapN=new r,this.overlapV=new r,this.clear()}o.Response=C,C.prototype.clear=C.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this};for(var B=[],Y=0;Y<10;Y++)B.push(new r);for(var X=[],Y=0;Y<5;Y++)X.push([]);var G=new C,v=new g(new r,1e-6,1e-6).toPolygon();function S(n,l,a){for(var p=Number.MAX_VALUE,u=-Number.MAX_VALUE,x=n.length,b=0;b<x;b++){var q=n[b].dot(l);q<p&&(p=q),q>u&&(u=q)}a[0]=p,a[1]=u}function k(n,l,a,p,u,x){var b=X.pop(),q=X.pop(),M=B.pop().copy(l).sub(n),P=M.dot(u);if(S(a,u,b),S(p,u,q),q[0]+=P,q[1]+=P,b[0]>q[1]||q[0]>b[1])return B.push(M),X.push(b),X.push(q),!0;if(x){var O=0;if(b[0]<q[0])if(x.aInB=!1,b[1]<q[1])O=b[1]-q[0],x.bInA=!1;else{var W=b[1]-q[0],N=q[1]-b[0];O=W<N?W:-N}else if(x.bInA=!1,b[1]>q[1])O=b[0]-q[1],x.aInB=!1;else{var W=b[1]-q[0],N=q[1]-b[0];O=W<N?W:-N}var R=Math.abs(O);R<x.overlap&&(x.overlap=R,x.overlapN.copy(u),O<0&&x.overlapN.reverse())}return B.push(M),X.push(b),X.push(q),!1}o.isSeparatingAxis=k;function L(n,l){var a=n.len2(),p=l.dot(n);return p<0?E:p>a?s:T}var E=-1,T=0,s=1;function i(n,l){var a=B.pop().copy(n).sub(l.pos).sub(l.offset),p=l.r*l.r,u=a.len2();return B.push(a),u<=p}o.pointInCircle=i;function A(n,l){v.pos.copy(n),G.clear();var a=w(v,l,G);return a&&(a=G.aInB),a}o.pointInPolygon=A;function m(n,l,a){var p=B.pop().copy(l.pos).add(l.offset).sub(n.pos).sub(n.offset),u=n.r+l.r,x=u*u,b=p.len2();if(b>x)return B.push(p),!1;if(a){var q=Math.sqrt(b);a.a=n,a.b=l,a.overlap=u-q,a.overlapN.copy(p.normalize()),a.overlapV.copy(p).scale(a.overlap),a.aInB=n.r<=l.r&&q<=l.r-n.r,a.bInA=l.r<=n.r&&q<=n.r-l.r}return B.push(p),!0}o.testCircleCircle=m;function f(n,l,a){for(var p=B.pop().copy(l.pos).add(l.offset).sub(n.pos),u=l.r,x=u*u,b=n.calcPoints,q=b.length,M=B.pop(),P=B.pop(),O=0;O<q;O++){var W=O===q-1?0:O+1,N=O===0?q-1:O-1,R=0,ft=null;M.copy(n.edges[O]),P.copy(p).sub(b[O]),a&&P.len2()>x&&(a.aInB=!1);var lt=L(M,P);if(lt===E){M.copy(n.edges[N]);var re=B.pop().copy(p).sub(b[N]);if(lt=L(M,re),lt===s){var z=P.len();if(z>u)return B.push(p),B.push(M),B.push(P),B.push(re),!1;a&&(a.bInA=!1,ft=P.normalize(),R=u-z)}B.push(re)}else if(lt===s){if(M.copy(n.edges[W]),P.copy(p).sub(b[W]),lt=L(M,P),lt===E){var z=P.len();if(z>u)return B.push(p),B.push(M),B.push(P),!1;a&&(a.bInA=!1,ft=P.normalize(),R=u-z)}}else{var ae=M.perp().normalize(),z=P.dot(ae),tr=Math.abs(z);if(z>0&&tr>u)return B.push(p),B.push(ae),B.push(P),!1;a&&(ft=ae,R=u-z,(z>=0||R<2*u)&&(a.bInA=!1))}ft&&a&&Math.abs(R)<Math.abs(a.overlap)&&(a.overlap=R,a.overlapN.copy(ft))}return a&&(a.a=n,a.b=l,a.overlapV.copy(a.overlapN).scale(a.overlap)),B.push(p),B.push(M),B.push(P),!0}o.testPolygonCircle=f;function y(n,l,a){var p=f(l,n,a);if(p&&a){var u=a.a,x=a.aInB;a.overlapN.reverse(),a.overlapV.reverse(),a.a=a.b,a.b=u,a.aInB=a.bInA,a.bInA=x}return p}o.testCirclePolygon=y;function w(n,l,a){for(var p=n.calcPoints,u=p.length,x=l.calcPoints,b=x.length,q=0;q<u;q++)if(k(n.pos,l.pos,p,x,n.normals[q],a))return!1;for(var q=0;q<b;q++)if(k(n.pos,l.pos,p,x,l.normals[q],a))return!1;return a&&(a.a=n,a.b=l,a.overlapV.copy(a.overlapN).scale(a.overlap)),!0}return o.testPolygonPolygon=w,o})})(pi);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Types=t.Response=void 0;var e=rt;Object.defineProperty(t,"Response",{enumerable:!0,get:function(){return e.Response}}),function(o){o.Ellipse="Ellipse",o.Line="Line",o.Circle="Circle",o.Box="Box",o.Point="Point",o.Polygon="Polygon"}(t.Types||(t.Types={}))})(j);var Lt={},I={},yt={},vt={},vo;function Pt(){if(vo)return vt;vo=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.Polygon=void 0;const t=rt,e=j,o=ct();class r extends t.Polygon{constructor(c,g){if(super((0,o.ensureVectorPoint)(c),(0,o.ensurePolygonPoints)(g)),this.type=e.Types.Polygon,!(g!=null&&g.length))throw new Error("No points in polygon");this.updateAABB()}get x(){return this.pos.x}set x(c){var g;this.pos.x=c,(g=this.system)===null||g===void 0||g.updateBody(this)}get y(){return this.pos.y}set y(c){var g;this.pos.y=c,(g=this.system)===null||g===void 0||g.updateBody(this)}setPosition(c,g){var C;this.pos.x=c,this.pos.y=g,(C=this.system)===null||C===void 0||C.updateBody(this)}updateAABB(){const{pos:c,w:g,h:C}=this.getAABBAsBox();this.minX=c.x,this.minY=c.y,this.maxX=c.x+g,this.maxY=c.y+C}draw(c){[...this.calcPoints,this.calcPoints[0]].forEach((C,B)=>{const Y=this.pos.x+C.x,X=this.pos.y+C.y,G=this.calcPoints[B-1]||this.calcPoints[this.calcPoints.length-1];if(!B)this.calcPoints.length===1?c.arc(Y,X,1,0,Math.PI*2):c.moveTo(Y,X);else if(this.calcPoints.length>1)if(this.isTrigger){const v=this.pos.x+G.x,S=this.pos.y+G.y;(0,o.dashLineTo)(c,v,S,Y,X)}else c.lineTo(Y,X)})}}return vt.Polygon=r,vt}var go;function ze(){if(go)return yt;go=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.Line=void 0;const t=j,e=Pt();class o extends e.Polygon{constructor(d,c){if(super({x:(d.x+c.x)/2,y:(d.y+c.y)/2},[{x:-(c.x-d.x)/2,y:-(c.y-d.y)/2},{x:(c.x-d.x)/2,y:(c.y-d.y)/2}]),this.type=t.Types.Line,this.calcPoints.length===1||!c)throw console.error({start:d,end:c}),new Error("No end point for line provided")}get start(){return{x:this.x+this.calcPoints[0].x,y:this.y+this.calcPoints[0].y}}get end(){return{x:this.x+this.calcPoints[1].x,y:this.y+this.calcPoints[1].y}}}return yt.Line=o,yt}var wo;function ct(){if(wo)return I;wo=1,Object.defineProperty(I,"__esModule",{value:!0}),I.intersectLinePolygon=I.intersectLineLine=I.intersectLineCircle=I.dashLineTo=I.clockwise=I.distance=I.ensurePolygonPoints=I.ensureVectorPoint=I.createBox=I.createEllipse=void 0;const t=rt,e=ze();function o(v,S=v,k=1){const L=Math.PI*Math.hypot(v,S)*2,E=Math.max(8,Math.ceil(L/k));return Array.from({length:E},(T,s)=>{const i=s/E*2*Math.PI,A=Math.cos(i)*v,m=Math.sin(i)*S;return new t.Vector(A,m)})}I.createEllipse=o;function r(v,S){return[new t.Vector(0,0),new t.Vector(v,0),new t.Vector(v,S),new t.Vector(0,S)]}I.createBox=r;function d(v={}){return v instanceof t.Vector?v:new t.Vector(v.x||0,v.y||0)}I.ensureVectorPoint=d;function c(v){if(!v)throw new Error("No points array provided");const S=v.map(d);return C(S)?S.reverse():S}I.ensurePolygonPoints=c;function g(v,S){return Math.hypot(v.x-S.x,v.y-S.y)}I.distance=g;function C(v){let S=0;for(let k=0;k<v.length;k++){const L=v[k],E=v[(k+1)%v.length];S+=(E.x-L.x)*(E.y+L.y)}return S>0}I.clockwise=C;function B(v,S,k,L,E,T=2,s=4){const i=L-S,A=E-k,m=Math.atan2(A,i),f=Math.cos(m),y=Math.sin(m);let w=S,n=k,l=Math.hypot(i,A);for(;l>0;){const a=Math.min(l,T);v.moveTo(w,n),v.lineTo(w+f*a,n+y*a),w+=f*(T+s),n+=y*(T+s),l-=T+s}}I.dashLineTo=B;function Y(v,S){const k={x:v.end.x-v.start.x,y:v.end.y-v.start.y},L={x:v.start.x-S.pos.x,y:v.start.y-S.pos.y},E=(k.x*L.x+k.y*L.y)*-2,T=(k.x*k.x+k.y*k.y)*2,s=Math.sqrt(E*E-(L.x*L.x+L.y*L.y-S.r*S.r)*T*2);if(isNaN(s))return[];const i=(E-s)/T,A=(E+s)/T,m=[];return i<=1&&i>=0&&m.push({x:v.start.x+k.x*i,y:v.start.y+k.y*i}),A<=1&&A>=0&&m.push({x:v.start.x+k.x*A,y:v.start.y+k.y*A}),m}I.intersectLineCircle=Y;function X(v,S){const k=v.end.x-v.start.x,L=v.end.y-v.start.y,E=k*(S.end.y-S.start.y)-(S.end.x-S.start.x)*L;if(E===0)return null;const T=((S.end.y-S.start.y)*(S.end.x-v.start.x)+(S.start.x-S.end.x)*(S.end.y-v.start.y))/E,s=((v.start.y-v.end.y)*(S.end.x-v.start.x)+k*(S.end.y-v.start.y))/E;return!(T>=0&&T<=1)||!(s>=0&&s<=1)?null:{x:v.start.x+T*k,y:v.start.y+T*L}}I.intersectLineLine=X;function G(v,S){return S.calcPoints.map((k,L)=>{const E=L?S.calcPoints[L-1]:S.calcPoints[S.calcPoints.length-1],T=new e.Line({x:E.x+S.pos.x,y:E.y+S.pos.y},{x:k.x+S.pos.x,y:k.y+S.pos.y});return X(v,T)}).filter(k=>!!k)}return I.intersectLinePolygon=G,I}Object.defineProperty(Lt,"__esModule",{value:!0});Lt.Circle=void 0;const hi=rt,mi=j,So=ct();class fi extends hi.Circle{constructor(e,o){super((0,So.ensureVectorPoint)(e),o),this.type=mi.Types.Circle,this.updateAABB()}get x(){return this.pos.x}set x(e){var o;this.pos.x=e,(o=this.system)===null||o===void 0||o.updateBody(this)}get y(){return this.pos.y}set y(e){var o;this.pos.y=e,(o=this.system)===null||o===void 0||o.updateBody(this)}setPosition(e,o){var r;this.pos.x=e,this.pos.y=o,(r=this.system)===null||r===void 0||r.updateBody(this)}updateAABB(){this.minX=this.pos.x-this.r,this.minY=this.pos.y-this.r,this.maxX=this.pos.x+this.r,this.maxY=this.pos.y+this.r}draw(e){const o=this.r;if(this.isTrigger){const r=Math.max(8,o);for(let d=0;d<r;d++){const c=d/r*2*Math.PI,g=(d-1)/r*2*Math.PI,C=this.pos.x+Math.cos(g)*o,B=this.pos.y+Math.sin(g)*o,Y=this.pos.x+Math.cos(c)*o,X=this.pos.y+Math.sin(c)*o;(0,So.dashLineTo)(e,C,B,Y,X)}}else e.moveTo(this.pos.x+o,this.pos.y),e.arc(this.pos.x,this.pos.y,o,0,Math.PI*2)}}Lt.Circle=fi;var It={};Object.defineProperty(It,"__esModule",{value:!0});It.Ellipse=void 0;const yi=j,Yt=ct(),vi=Pt();class gi extends vi.Polygon{constructor(e,o,r=o,d=Math.hypot(o,r)/Math.PI){super(e,(0,Yt.createEllipse)(o,r,d)),this.type=yi.Types.Ellipse,this._radiusX=o,this._radiusY=r,this._step=d}get step(){return this._step}set step(e){this._step=e,this.setPoints((0,Yt.createEllipse)(this._radiusX,this._radiusY,this._step))}get radiusX(){return this._radiusX}set radiusX(e){this._radiusX=e,this.setPoints((0,Yt.createEllipse)(this._radiusX,this._radiusY,this._step))}get radiusY(){return this._radiusY}set radiusY(e){this._radiusY=e,this.setPoints((0,Yt.createEllipse)(this._radiusX,this._radiusY,this._step))}}It.Ellipse=gi;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.Box=void 0;const wi=j,le=ct(),Si=Pt();class xi extends Si.Polygon{constructor(e,o,r){super(e,(0,le.createBox)(o,r)),this.type=wi.Types.Box,this._width=o,this._height=r}get width(){return this._width}set width(e){this._width=e,this.setPoints((0,le.createBox)(this._width,this._height))}get height(){return this._height}set height(e){this._height=e,this.setPoints((0,le.createBox)(this._width,this._height))}getCentroidWithoutRotation(){const e=this.angle;this.setAngle(0);const o=this.getCentroid();return this.setAngle(e),o}center(){const e=this.points[0];if(e.x!==0||e.y!==0)return;const{x:o,y:r}=this.getCentroidWithoutRotation();this.translate(-o,-r),this.setPosition(this.pos.x+o,this.pos.y+r)}}mt.Box=xi;var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.Point=void 0;const bi=mt,Bi=j,ki=ct();class Ci extends bi.Box{constructor(e){super((0,ki.ensureVectorPoint)(e),.1,.1),this.type=Bi.Types.Point}}Xt.Point=Ci;var ee={},Se={},Ei={get exports(){return Se},set exports(t){Se=t}};(function(t,e){(function(o,r){t.exports=r()})($,function(){function o(s,i,A,m,f){(function y(w,n,l,a,p){for(;a>l;){if(a-l>600){var u=a-l+1,x=n-l+1,b=Math.log(u),q=.5*Math.exp(2*b/3),M=.5*Math.sqrt(b*q*(u-q)/u)*(x-u/2<0?-1:1),P=Math.max(l,Math.floor(n-x*q/u+M)),O=Math.min(a,Math.floor(n+(u-x)*q/u+M));y(w,n,P,O,p)}var W=w[n],N=l,R=a;for(r(w,l,n),p(w[a],W)>0&&r(w,l,a);N<R;){for(r(w,N,R),N++,R--;p(w[N],W)<0;)N++;for(;p(w[R],W)>0;)R--}p(w[l],W)===0?r(w,l,R):r(w,++R,a),R<=n&&(l=R+1),n<=R&&(a=R-1)}})(s,i,A||0,m||s.length-1,f||d)}function r(s,i,A){var m=s[i];s[i]=s[A],s[A]=m}function d(s,i){return s<i?-1:s>i?1:0}var c=function(s){s===void 0&&(s=9),this._maxEntries=Math.max(4,s),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function g(s,i,A){if(!A)return i.indexOf(s);for(var m=0;m<i.length;m++)if(A(s,i[m]))return m;return-1}function C(s,i){B(s,0,s.children.length,i,s)}function B(s,i,A,m,f){f||(f=E(null)),f.minX=1/0,f.minY=1/0,f.maxX=-1/0,f.maxY=-1/0;for(var y=i;y<A;y++){var w=s.children[y];Y(f,s.leaf?m(w):w)}return f}function Y(s,i){return s.minX=Math.min(s.minX,i.minX),s.minY=Math.min(s.minY,i.minY),s.maxX=Math.max(s.maxX,i.maxX),s.maxY=Math.max(s.maxY,i.maxY),s}function X(s,i){return s.minX-i.minX}function G(s,i){return s.minY-i.minY}function v(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function S(s){return s.maxX-s.minX+(s.maxY-s.minY)}function k(s,i){return s.minX<=i.minX&&s.minY<=i.minY&&i.maxX<=s.maxX&&i.maxY<=s.maxY}function L(s,i){return i.minX<=s.maxX&&i.minY<=s.maxY&&i.maxX>=s.minX&&i.maxY>=s.minY}function E(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(s,i,A,m,f){for(var y=[i,A];y.length;)if(!((A=y.pop())-(i=y.pop())<=m)){var w=i+Math.ceil((A-i)/m/2)*m;o(s,w,i,A,f),y.push(i,w,w,A)}}return c.prototype.all=function(){return this._all(this.data,[])},c.prototype.search=function(s){var i=this.data,A=[];if(!L(s,i))return A;for(var m=this.toBBox,f=[];i;){for(var y=0;y<i.children.length;y++){var w=i.children[y],n=i.leaf?m(w):w;L(s,n)&&(i.leaf?A.push(w):k(s,n)?this._all(w,A):f.push(w))}i=f.pop()}return A},c.prototype.collides=function(s){var i=this.data;if(!L(s,i))return!1;for(var A=[];i;){for(var m=0;m<i.children.length;m++){var f=i.children[m],y=i.leaf?this.toBBox(f):f;if(L(s,y)){if(i.leaf||k(s,y))return!0;A.push(f)}}i=A.pop()}return!1},c.prototype.load=function(s){if(!s||!s.length)return this;if(s.length<this._minEntries){for(var i=0;i<s.length;i++)this.insert(s[i]);return this}var A=this._build(s.slice(),0,s.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(this.data.height<A.height){var m=this.data;this.data=A,A=m}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this},c.prototype.insert=function(s){return s&&this._insert(s,this.data.height-1),this},c.prototype.clear=function(){return this.data=E([]),this},c.prototype.remove=function(s,i){if(!s)return this;for(var A,m,f,y=this.data,w=this.toBBox(s),n=[],l=[];y||n.length;){if(y||(y=n.pop(),m=n[n.length-1],A=l.pop(),f=!0),y.leaf){var a=g(s,y.children,i);if(a!==-1)return y.children.splice(a,1),n.push(y),this._condense(n),this}f||y.leaf||!k(y,w)?m?(A++,y=m.children[A],f=!1):y=null:(n.push(y),l.push(A),A=0,m=y,y=y.children[0])}return this},c.prototype.toBBox=function(s){return s},c.prototype.compareMinX=function(s,i){return s.minX-i.minX},c.prototype.compareMinY=function(s,i){return s.minY-i.minY},c.prototype.toJSON=function(){return this.data},c.prototype.fromJSON=function(s){return this.data=s,this},c.prototype._all=function(s,i){for(var A=[];s;)s.leaf?i.push.apply(i,s.children):A.push.apply(A,s.children),s=A.pop();return i},c.prototype._build=function(s,i,A,m){var f,y=A-i+1,w=this._maxEntries;if(y<=w)return C(f=E(s.slice(i,A+1)),this.toBBox),f;m||(m=Math.ceil(Math.log(y)/Math.log(w)),w=Math.ceil(y/Math.pow(w,m-1))),(f=E([])).leaf=!1,f.height=m;var n=Math.ceil(y/w),l=n*Math.ceil(Math.sqrt(w));T(s,i,A,l,this.compareMinX);for(var a=i;a<=A;a+=l){var p=Math.min(a+l-1,A);T(s,a,p,n,this.compareMinY);for(var u=a;u<=p;u+=n){var x=Math.min(u+n-1,p);f.children.push(this._build(s,u,x,m-1))}}return C(f,this.toBBox),f},c.prototype._chooseSubtree=function(s,i,A,m){for(;m.push(i),!i.leaf&&m.length-1!==A;){for(var f=1/0,y=1/0,w=void 0,n=0;n<i.children.length;n++){var l=i.children[n],a=v(l),p=(u=s,x=l,(Math.max(x.maxX,u.maxX)-Math.min(x.minX,u.minX))*(Math.max(x.maxY,u.maxY)-Math.min(x.minY,u.minY))-a);p<y?(y=p,f=a<f?a:f,w=l):p===y&&a<f&&(f=a,w=l)}i=w||i.children[0]}var u,x;return i},c.prototype._insert=function(s,i,A){var m=A?s:this.toBBox(s),f=[],y=this._chooseSubtree(m,this.data,i,f);for(y.children.push(s),Y(y,m);i>=0&&f[i].children.length>this._maxEntries;)this._split(f,i),i--;this._adjustParentBBoxes(m,f,i)},c.prototype._split=function(s,i){var A=s[i],m=A.children.length,f=this._minEntries;this._chooseSplitAxis(A,f,m);var y=this._chooseSplitIndex(A,f,m),w=E(A.children.splice(y,A.children.length-y));w.height=A.height,w.leaf=A.leaf,C(A,this.toBBox),C(w,this.toBBox),i?s[i-1].children.push(w):this._splitRoot(A,w)},c.prototype._splitRoot=function(s,i){this.data=E([s,i]),this.data.height=s.height+1,this.data.leaf=!1,C(this.data,this.toBBox)},c.prototype._chooseSplitIndex=function(s,i,A){for(var m,f,y,w,n,l,a,p=1/0,u=1/0,x=i;x<=A-i;x++){var b=B(s,0,x,this.toBBox),q=B(s,x,A,this.toBBox),M=(f=b,y=q,w=void 0,n=void 0,l=void 0,a=void 0,w=Math.max(f.minX,y.minX),n=Math.max(f.minY,y.minY),l=Math.min(f.maxX,y.maxX),a=Math.min(f.maxY,y.maxY),Math.max(0,l-w)*Math.max(0,a-n)),P=v(b)+v(q);M<p?(p=M,m=x,u=P<u?P:u):M===p&&P<u&&(u=P,m=x)}return m||A-i},c.prototype._chooseSplitAxis=function(s,i,A){var m=s.leaf?this.compareMinX:X,f=s.leaf?this.compareMinY:G;this._allDistMargin(s,i,A,m)<this._allDistMargin(s,i,A,f)&&s.children.sort(m)},c.prototype._allDistMargin=function(s,i,A,m){s.children.sort(m);for(var f=this.toBBox,y=B(s,0,i,f),w=B(s,A-i,A,f),n=S(y)+S(w),l=i;l<A-i;l++){var a=s.children[l];Y(y,s.leaf?f(a):a),n+=S(y)}for(var p=A-i-1;p>=i;p--){var u=s.children[p];Y(w,s.leaf?f(u):u),n+=S(w)}return n},c.prototype._adjustParentBBoxes=function(s,i,A){for(var m=A;m>=0;m--)Y(i[m],s)},c.prototype._condense=function(s){for(var i=s.length-1,A=void 0;i>=0;i--)s[i].children.length===0?i>0?(A=s[i-1].children).splice(A.indexOf(s[i]),1):this.clear():C(s[i],this.toBBox)},c})})(Ei);var Mi=$&&$.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ee,"__esModule",{value:!0});ee.System=void 0;const Tt=rt,Li=Mi(Se),K=j,gt=ct(),Pi=Xt,Ii=Lt,Xi=mt,Ae=Pt(),Yi=ze(),Ti=It;class Ri extends Li.default{constructor(){super(...arguments),this.response=new K.Response}draw(e){this.all().forEach(o=>{o.draw(e)})}drawBVH(e){this.data.children.forEach(({minX:o,maxX:r,minY:d,maxY:c})=>{Ae.Polygon.prototype.draw.call({pos:{x:o,y:d},calcPoints:(0,gt.createBox)(r-o,c-d)},e)}),this.all().forEach(o=>{const{pos:r,w:d,h:c}=o.getAABBAsBox();Ae.Polygon.prototype.draw.call({pos:r,calcPoints:(0,gt.createBox)(d,c)},e)})}updateBody(e){this.remove(e),e.updateAABB(),this.insert(e)}remove(e,o){return e.system=void 0,super.remove(e,o)}insert(e){return e.system=this,super.insert(e)}update(){this.all().forEach(e=>{e.isStatic||this.updateBody(e)})}separate(){this.checkAll(e=>{e.a.isTrigger||(e.a.pos.x-=e.overlapV.x,e.a.pos.y-=e.overlapV.y,this.updateBody(e.a))})}checkOne(e,o){e.isStatic||this.getPotentials(e).forEach(r=>{this.checkCollision(e,r)&&o(this.response)})}checkAll(e){this.all().forEach(o=>{this.checkOne(o,e)})}getPotentials(e){return this.search(e).filter(o=>o!==e)}checkCollision(e,o){if(this.response.clear(),e.type===K.Types.Circle&&o.type===K.Types.Circle)return(0,Tt.testCircleCircle)(e,o,this.response);if(e.type===K.Types.Circle&&o.type!==K.Types.Circle)return(0,Tt.testCirclePolygon)(e,o,this.response);if(e.type!==K.Types.Circle&&o.type===K.Types.Circle)return(0,Tt.testPolygonCircle)(e,o,this.response);if(e.type!==K.Types.Circle&&o.type!==K.Types.Circle)return(0,Tt.testPolygonPolygon)(e,o,this.response);throw Error("Not implemented")}raycast(e,o,r=()=>!0){let d=1/0,c=null;const g=this.createLine(e,o),C=this.getPotentials(g).filter(B=>r(B)&&this.checkCollision(g,B));return this.remove(g),C.forEach(B=>{(B.type===K.Types.Circle?(0,gt.intersectLineCircle)(g,B):(0,gt.intersectLinePolygon)(g,B)).forEach(X=>{const G=(0,gt.distance)(e,X);G<d&&(d=G,c={point:X,collider:B})})}),c}createPoint(e){const o=new Pi.Point(e);return this.insert(o),o}createLine(e,o,r=0){const d=new Yi.Line(e,o);return d.setAngle(r),this.insert(d),d}createCircle(e,o){const r=new Ii.Circle(e,o);return this.insert(r),r}createBox(e,o,r,d=0){const c=new Xi.Box(e,o,r);return c.setAngle(d),this.insert(c),c}createEllipse(e,o,r,d,c=0){const g=new Ti.Ellipse(e,o,r,d);return g.setAngle(c),this.insert(g),g}createPolygon(e,o,r=0){const d=new Ae.Polygon(e,o);return d.setAngle(r),this.insert(d),d}}ee.System=Ri;(function(t){var e=$&&$.__createBinding||(Object.create?function(r,d,c,g){g===void 0&&(g=c);var C=Object.getOwnPropertyDescriptor(d,c);(!C||("get"in C?!d.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return d[c]}}),Object.defineProperty(r,g,C)}:function(r,d,c,g){g===void 0&&(g=c),r[g]=d[c]}),o=$&&$.__exportStar||function(r,d){for(var c in r)c!=="default"&&!Object.prototype.hasOwnProperty.call(d,c)&&e(d,r,c)};Object.defineProperty(t,"__esModule",{value:!0}),o(j,t),o(Lt,t),o(It,t),o(Pt(),t),o(mt,t),o(Xt,t),o(ze(),t),o(ee,t),o(ct(),t)})(Ve);const tt=new Ve.System,Hn=t=>{tt.insert(t),tt.updateBody(t)},xt=t=>{tt.remove(t)},U=(t,e,o)=>{const r=new Ve.Box(t,e,o);return Hn(r),r};let jn;const Jn=()=>jn,Oi=()=>{jn=U({x:0,y:0},2,2)},_n=new V,$n=()=>{requestAnimationFrame($n);const t=Ie(),e=Jr(),o=Xe();_n.broadcast({x:t,y:e,z:o})};requestAnimationFrame($n);const Zi=()=>{const t=Jn();tt.updateBody(t),tt.getPotentials(t).forEach(e=>{tt.checkCollision(t,e)&&Ui(tt.response)})},Ui=t=>{t.overlap&&(t.overlapV.x&&pt(at()-t.overlapV.x),t.overlapV.y&&ht(it()-t.overlapV.y))},Di=({x:t,z:e})=>{var o;(o=Jn())==null||o.setPosition(t,e),Zi()},Qi=()=>{_n.subscribe(Di)};let xe;const Wi=t=>{xe=t};let ts;const Fi=()=>{const t=xe[Ma(0,xe.length)];h.play(t)},Ni=()=>{ts=setInterval(Fi,4e4)},Gi=()=>{clearInterval(ts)},es=document.getElementById("mouseLockHint"),os=()=>{es.classList.remove("hidden")},ns=()=>{es.classList.add("hidden")},Vi=100,ss=200;let Bt,be=ss,Ke=!0;const zi=()=>{Ke=!0},Ki=()=>{Ke=!1},Hi=()=>{Ke&&h.play("playerSteps1")},rs=()=>{Bt=setInterval(Hi,be)},as=()=>{clearInterval(Bt),Bt=void 0},de=new Set,is=({state:t,direction:e})=>{if(t){if(de.add(e),Bt)return;rs()}else{if(de.delete(e),de.size)return;as()}},ji=t=>{t?be=Vi:be=ss,Bt&&(as(),rs())};et.subscribe(is);ot.subscribe(is);Ue.subscribe(ji);let cs=!1;const Ji=t=>{cs=t},_i=()=>{At.subscribe(Ji)},ls=()=>cs,He=document.getElementById("activeItemTips"),J=t=>{$i(t),tc()},$i=t=>{He.textContent=t},tc=()=>{He.classList.remove("hide")},Q=()=>{He.classList.add("hide")},je=new V,Je=document.querySelector("#room1 .wallBtnWrap"),ec=()=>{nt("room1WallBtn"),ds(),Q()},As=({code:t})=>{t==="KeyE"&&(Je.classList.add("pressed"),h.play("wall_btn_press"),ec(),je.broadcast())},oc=()=>{Je.classList.add("active"),document.addEventListener("keydown",As),J("press E")},ds=()=>{Je.classList.remove("active"),document.removeEventListener("keydown",As),Q()};F("room1WallBtn",{isActive:!1,maxX:1900,minX:1350,maxZ:650,minZ:350,activationCallback:oc,deactivationCallback:ds});const qs=new V,_e=document.querySelector("#room5 .wallBtnWrap"),nc=()=>{nt("room5WallBtn"),ps(),Q()},us=({code:t})=>{t==="KeyE"&&(_e.classList.add("pressed"),h.play("wall_btn_press"),setTimeout(()=>{h.play("glassWallSound")},500),nc(),qs.broadcast())},sc=()=>{_e.classList.add("active"),document.addEventListener("keydown",us),J("press E")},ps=()=>{_e.classList.remove("active"),document.removeEventListener("keydown",us),Q()};F("room5WallBtn",{isActive:!1,maxX:950,minX:600,maxZ:3600,minZ:3350,activationCallback:sc,deactivationCallback:ps});U({x:-800,y:-730},2800,200);U({x:-700,y:-730},200,4500);const rc=U({x:500,y:200},200,750),ac=U({x:500,y:200},430,200),ic=U({x:500,y:800},500,200);U({x:910,y:600},200,500);const cc=()=>{xt(rc),xt(ac),xt(ic)};U({x:1900,y:-730},200,1500);U({x:2e3,y:700},-1200,200);U({x:900,y:800},200,-900);const hs=U({x:900,y:-600},200,800),lc=()=>{xt(hs)},Ac=()=>{Hn(hs)};U({x:2100,y:1e3},200,1600);U({x:2200,y:2450},-1250,100);U({x:2200,y:1e3},-1250,100);const dc=U({x:920,y:1e3},200,1600),qc=()=>{xt(dc)};qs.subscribe(qc);U({x:920,y:2500},200,1200);U({x:-600,y:3550},1600,200);const uc=U({x:-600,y:2650},1600,300),pc=()=>{uc.setPosition(-200,2650)};je.subscribe(pc);Wi(["lvlBg1","lvlBg2","lvlBg3","lvlBg4"]);const ms=t=>{t?os():ns()},hc=()=>{At.subscribe(ms)},mc=()=>{At.unsubscribe(ms)},fc=({x:t,y:e,z:o,angleX:r,angleY:d})=>{pt(t),Pe(e),ht(o),jr({x:t,y:e,z:o}),Ge({movementX:r,movementY:d})},yc=800,vc=16,gc=687,wc=0,Sc=0;fc({x:yc,y:vc,z:gc,angleX:wc,angleY:Sc});const xc=document.getElementById("healSpell"),xo=70,bc=()=>{document.addEventListener("keydown",fs)},Bc=()=>{document.removeEventListener("keydown",fs)},kc=()=>{xc.animate([{opacity:.5},{opacity:1},{opacity:.5}],{duration:500})},fs=({code:t})=>{if(t==="KeyT"){if(In()<xo){Pn(),h.play("notEnoughMana");return}Xn(xo),ya(40),kc(),h.play("healSpell")}},Cc=document.getElementById("healSpell"),$e=document.querySelector("#room2 .spell1"),to=({code:t})=>{t==="KeyE"&&(document.removeEventListener("keydown",to),nt("room2HealSpell"),Q(),$e.remove(),Cc.classList.remove("hide"),h.play("pickingSpell"),bc())},Ec=()=>{$e.style.filter="brightness(0.8)",document.addEventListener("keydown",to),J("press E")},Mc=()=>{$e.style.filter="brightness(0.5)",document.removeEventListener("keydown",to),Q()};F("room2HealSpell",{isActive:!1,maxX:0,minX:-550,maxZ:50,minZ:-570,activationCallback:Ec,deactivationCallback:Mc});const zt=new Map,ys=document.getElementById("lvlTaskWrap"),Lc=ys.getElementsByClassName("lvlTaskList")[0],Pc=()=>{ys.classList.remove("hide")},Ic=()=>{zt.forEach(({elem:t})=>{t.remove()}),zt.clear()},vs=(t,e)=>{const o=document.createElement("li");o.textContent=e,zt.set(t,{title:e,elem:o}),Lc.append(o)},Xc=t=>{t.forEach(([e,o])=>{vs(e,o)})},Yc=t=>{var e;(e=zt.get(t))==null||e.elem.classList.add("done")},gs=document.getElementById("openedScrollWrap"),Tc=document.getElementById("openedScroll"),Rc=document.getElementById("scrollContentWrap"),Oc=({code:t})=>{t==="KeyQ"&&Zc()},ws=()=>Tc,Ss=t=>{Rc.innerHTML=t},xs=()=>{Mt(!1),h.play("scrollRead"),gs.classList.add("open"),window.addEventListener("keydown",Oc)},Zc=()=>{h.play("scrollClose"),gs.classList.remove("open"),Mt(ls())},bs=document.querySelector("#room2 .scroll1");let Bs=!1;const ks=({code:t})=>{t==="KeyQ"&&(Q(),window.removeEventListener("keydown",ks),$t())},eo=({code:t})=>{if(t!=="KeyE")return;yn("room2Scroll");const e=ws();e.style.filter="brightness(0.8) hue-rotate(140deg)",Ss(`Further is a magic wall with portal behind it, somewhere 
  in this tunnels must be a way to reach it. I think I saw a light coming 
  from a crack near one of the walls. I wish you luck, it seems to me I 
  will stay here for ever...`),xs(),Q(),J("press Q"),window.addEventListener("keydown",ks),window.removeEventListener("keydown",eo),Bs||Uc()},Uc=()=>{Yc("blueScroll"),vs("main","find magic wall and way to go through it"),Bs=!0,h.play("taskDone")},Dc=()=>{bs.classList.add("active"),window.addEventListener("keydown",eo),J("press E")},Qc=()=>{bs.classList.remove("active"),window.removeEventListener("keydown",eo),Q()};F("room2Scroll",{isActive:!1,maxZ:800,minZ:200,maxX:-100,minX:-500,activationCallback:Dc,deactivationCallback:Qc});const Cs=()=>{h.loop("torch1",!0),h.play("torch1")},Es=()=>{h.loop("torch1",!1),h.stop("torch1")};F("room2Torch",{isActive:!1,maxX:450,minX:-150,maxZ:-200,minZ:-500,activationCallback:Cs,deactivationCallback:Es});const oo=()=>{h.loop("bugSound1",!0),h.play("bugSound1")},no=()=>{h.loop("bugSound1",!1),h.stop("bugSound1")};F("room2WallBug",{isActive:!1,maxX:950,minX:600,maxZ:250,minZ:-100,activationCallback:oo,deactivationCallback:no});let Ms,Ls;const Wc=()=>Ms,Fc=()=>Ls,Nc=t=>{Ls=t},Gc=t=>{Ms=t},Ps=new V,Is=()=>{const t=visualViewport.height!==Wc(),e=visualViewport.width!==Fc();Gc(visualViewport.height),Nc(visualViewport.width),Ps.broadcast({height:visualViewport.height,width:visualViewport.width,heightChanged:t,widthChanged:e})};visualViewport.addEventListener("resize",Is);const oe=document.getElementById("playerHands"),Vc=document.getElementById("playerHandsInner"),zc=t=>t/1.3/4|0,Kc=({height:t})=>{oe.style.height=t+"px",Vc.style.transform=`
    translateX(${zc(t)}px) 
    translateY(12%)`},Xs=()=>{oe.classList.remove("hide")},Hc=()=>{oe.classList.add("hide")};Ps.subscribe(Kc);let qe=!1;const Ys=async()=>{qe||(qe=!0,h.play("swordAttack"),await jc(),qe=!1)},bo=`
  rotateX(0deg) 
  rotateY(0deg) 
  rotateZ(0deg) 
  translateY(0px)
  translateX(0px)  
  skew(0deg, 0deg)
  scale(1)`,Bo=`
  rotateX(0deg) 
  rotateY(0deg) 
  rotateZ(15deg) 
  translateY(-150px)
  translateX(0px)  
  skew(0deg, -0deg)
  scale(1)`,ko=`
  rotateX(70deg)         
  rotateY(-50deg)         
  rotateZ(-20deg)         
  translateY(-3px)        
  translateX(0px)          
  skew(0deg, -30deg)        
  scale(1)`,ue=(t,e,o)=>oe.animate([{transform:t},{transform:e}],{duration:o}).finished,jc=async()=>{await ue(bo,Bo,120),await ue(Bo,ko,150),await ue(ko,bo,230)},Jc=()=>{window.addEventListener("click",Ys)},_c=()=>{window.removeEventListener("click",Ys)},so=document.querySelector("#room5 .swordItem1");let Ts=!1;const Rs=()=>Ts,ro=({code:t})=>{t==="KeyE"&&(window.removeEventListener("keydown",ro),so.remove(),Xs(),h.play("pickingSword"),Jc(),Ts=!0,nt("room5Sword"),Q())},$c=()=>{so.style.filter="brightness(1.5)",window.addEventListener("keydown",ro),J("press E")},tl=()=>{so.style.filter="brightness(1)",window.removeEventListener("keydown",ro),Q()};F("room5Sword",{isActive:!1,maxX:450,minX:-50,maxZ:3350,minZ:3050,activationCallback:$c,deactivationCallback:tl});const Co=50,Os=document.getElementById("bugSpell");let ao=!1;const el=()=>{document.addEventListener("keydown",Zs)},ol=()=>{document.removeEventListener("keydown",Zs)},Zs=({code:t})=>{t==="KeyR"&&(ao?nl():sl())},nl=()=>{ao=!1,h.play("transformSpell"),Pe(16),Os.style.opacity="0.5",zi(),zn(),Sn(),$t(),Ac(),Rs()&&Xs()},sl=()=>{if(In()<Co){Pn(),h.play("notEnoughMana");return}ao=!0,h.play("transformSpell"),Xn(Co),Pe(-420),Os.style.opacity="1",Ki(),Kn(),ma(),gn(),ua(),lc(),Rs()&&Hc()};let io;const rl=document.getElementById("room1"),al=document.getElementById("room3"),il=document.getElementById("room5"),cl=new Map([["room1",{isActive:!1,el:rl,coords:{minX:600,maxX:1900,minZ:-530,maxZ:700}}],["room3",{isActive:!1,el:al,coords:{minX:420,maxX:2100,minZ:1e3,maxZ:2450}}],["room5",{isActive:!1,el:il,coords:{minX:-600,maxX:950,minZ:2250,maxZ:3600}}]]);let Be,ke;const ll=()=>{Be=Ie(),ke=Xe()},Al=()=>{for(const t of cl.values())if(ke<=t.coords.maxZ&&ke>=t.coords.minZ&&Be<=t.coords.maxX&&Be>=t.coords.minX){if(t.isActive)return;t.isActive=!0,t.el.classList.remove("optimizeRender")}else t.isActive&&(t.isActive=!1,t.el.classList.add("optimizeRender"))},Us=()=>{io=requestAnimationFrame(Us),ll(),Al()},dl=()=>{io=requestAnimationFrame(Us)},ql=()=>{cancelAnimationFrame(io)},Ds=document.getElementById("lvl1EndScreen"),Qs=Ds.querySelector(".close"),ul=()=>{Ic(),ql(),mc(),ns(),Ra(),Oe(),Mt(!1),ol(),Bc(),Dt.stop(),Ft.stop(),Wt.stop(),Qt.stop(),_c(),Ka(),Gi(),Ds.classList.remove("hide"),h.loop("lvlEnd",!0),h.play("lvlEnd")},pl=()=>{h.play("menuButtonClick"),location.reload()},hl=()=>{ut.play("menuButtonHover")};Qs.addEventListener("mouseover",hl);Qs.addEventListener("click",pl);const ml=()=>{h.loop("portalRoomSound",!0),h.play("portalRoomSound")},Ws=()=>{h.loop("portalRoomSound",!1),h.stop("portalRoomSound")};F("room3portalRoomSound",{isActive:!1,maxX:2200,minX:950,maxZ:2500,minZ:1050,activationCallback:ml,deactivationCallback:Ws});const fl=()=>{Ws(),ul()};F("room3PortalEntering",{isActive:!1,maxX:2200,minX:2100,maxZ:2100,minZ:1300,activationCallback:fl,deactivationCallback:()=>{}});const Fs=document.querySelector("#room3 .scroll1"),Ns=({code:t})=>{t==="KeyQ"&&(Q(),window.removeEventListener("keydown",Ns),$t())},co=({code:t})=>{if(t!=="KeyE")return;const e=ws();e.style.filter="brightness(0.8) hue-rotate(260deg)",yn("room3Scroll"),Ss("further danger awaits you, better find some weapon and heal your wounds"),xs(),Q(),J("press Q"),window.addEventListener("keydown",Ns),window.removeEventListener("keydown",co)},yl=()=>{Fs.classList.add("active"),window.addEventListener("keydown",co),J("press E")},vl=()=>{Fs.classList.remove("active"),window.removeEventListener("keydown",co),Q()};F("room3Scroll",{isActive:!1,maxZ:2e3,minZ:1400,maxX:1600,minX:1100,activationCallback:yl,deactivationCallback:vl});const Gs=document.querySelector("#room3 .protectionOpacityWall"),gl=()=>{Gs.style.webkitMaskImage="radial-gradient(transparent 0%, black 15%)"},wl=()=>{Gs.style.webkitMaskImage="radial-gradient(transparent 0%, black 0%)"};F("secretWallFar",{isActive:!1,maxX:900,minX:450,maxZ:2100,minZ:1300,activationCallback:gl,deactivationCallback:wl});const Sl=document.getElementById("bugSpell"),lo=document.querySelector("#room4 .spell1"),Ao=({code:t})=>{t==="KeyE"&&(document.removeEventListener("keydown",Ao),nt("room4BugSpell"),Q(),lo.remove(),Sl.classList.remove("hide"),h.play("pickingSpell"),el())},xl=()=>{lo.style.filter="brightness(0.8)",document.addEventListener("keydown",Ao),J("press E")},bl=()=>{lo.style.filter="brightness(0.5)",document.removeEventListener("keydown",Ao),Q()};F("room4BugSpell",{isActive:!1,maxX:100,minX:-550,maxZ:2300,minZ:1300,activationCallback:xl,deactivationCallback:bl});F("room5FloorBug",{isActive:!1,maxX:450,minX:-100,maxZ:3250,minZ:2900,activationCallback:oo,deactivationCallback:no});F("room5ShieldBug",{isActive:!1,maxX:950,minX:750,maxZ:3250,minZ:2900,activationCallback:oo,deactivationCallback:no});F("room5Torch",{isActive:!1,maxX:-150,minX:-500,maxZ:3500,minZ:2500,activationCallback:Cs,deactivationCallback:Es});const Bl=document.querySelector("#room5 .bulkWallWrap"),kl=()=>{Bl.classList.add("open"),setTimeout(()=>{h.play("wall_opening")},1500)};je.subscribe(kl);const Cl=document.getElementById("camera"),Vs=()=>{requestAnimationFrame(Vs),Cl.style.transform=`
    rotateX(${en()}deg) 
    rotateY(${tn()}deg) 
    translateX(${at()}px) 
    translateZ(${it()}px)
    translateY(${$o()}px)
  `},El=()=>{requestAnimationFrame(Vs)},Ml=document.getElementById("scenesWrap"),zs=()=>{requestAnimationFrame(zs),Ml.style.transform=`
    translateX(${oi()}px) 
    translateZ(${ni()}px)
    translateY(${Qe()}px)
    rotateY(180deg)
  `},Ll=()=>{requestAnimationFrame(zs)},qo=document.getElementById("sceneScreen"),Pl=()=>{qo.classList.remove("transparent")},Ks=()=>{qo.classList.add("transparent")},Il=()=>qo,pe=document.querySelector("#room2 .bugWrap2"),Xl=()=>{pe.classList.add("moving","move"),pe.addEventListener("animationend",()=>{pe.classList.remove("moving")})},he="rotateX(270deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(-360px)",Eo="rotateX(330deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(-180px)",Mo="rotateX(330deg) rotateY(-50deg) translateX(800px) translateZ(687px) translateY(-180px)",Lo="rotateX(330deg) rotateY(35deg) translateX(800px) translateZ(687px) translateY(-180px)",Po="rotateX(300deg) rotateY(65deg) translateX(800px) translateZ(687px) translateY(-180px)",Io="rotateX(288deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(-180px)",Xo="rotateX(288deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(16px)",Yl="rotateX(360deg) rotateY(0deg) translateX(800px) translateZ(687px) translateY(16px)",Tl=document.getElementById("camera"),_=(t,e,o)=>Tl.animate([{transform:t},{transform:e}],{duration:o,easing:"ease"}).finished,Rl=t=>Il().animate([{backgroundColor:"black"},{backgroundColor:"transparent"}],{duration:t,easing:"ease",fill:"forwards"}).finished,Ol=async()=>{Rl(2e3),await _(he,he,1e3),await _(he,Eo,2e3),await _(Eo,Mo,3e3),await _(Mo,Lo,3e3),await _(Lo,Po,1e3),await _(Po,Io,1e3),await _(Io,Xo,1e3),Xl(),await _(Xo,Yl,1e3),Ks()},Zl=()=>{El(),Ll(),Oi(),Qi(),os(),dl(),Ai(),Xc([["blueScroll","read blue scroll"]]),Pc(),fa(40),Ga(0)},Ul=async()=>{Ta(),Et(),h.play("awakeningOST"),await Ol(),Sn(),hc(),ui(),Mt(ls()),Wa(),za(),Nr(),Ni()},Hs=document.getElementById("gameSection"),Yo=()=>{Hs.classList.remove("hide")},Dl=()=>{Hs.classList.add("hide")},ne=document.getElementById("menu"),To=()=>{ne.classList.add("hide"),h.loop("menuBg",!1),h.stop("menuBg")},js=()=>{h.loop("menuBg",!0),h.play("menuBg"),ne.classList.remove("hide")},Ql=({target:t})=>{t.classList.contains("menu_button")&&ut.play("menuButtonHover")},Ce=()=>{window.removeEventListener("keydown",Ce),Wr(),js(),Ot(),Dl(),Pl(),Oe()},Wl=({target:t})=>{if(!t.classList.contains("menu_button"))return;const e=t.dataset.action;switch(h.play("menuButtonClick"),e){case"startGame":{me("Explore your surroundings carefully"),fe(),po(),Yo(),To(),_i(),Zl(),setTimeout(()=>{Ot(),Ul()},1e3);return}case"openControlsSubPanel":{Gt("controlsSection");return}case"openAboutSubPanel":{Gt("aboutSection");return}case"startFpsTour":{me("press Esc to return to the menu"),fe(),po(),Yo(),To(),setTimeout(()=>{const o=Qr();Ot(),Ks(),o.onfinish=Ce,window.addEventListener("keydown",Ce),Et()},1e3);return}default:throw"menu button with unknown action"}};ne.addEventListener("click",Wl);ne.addEventListener("mouseover",Ql);document.querySelector(".menu_button.flicker").addEventListener("click",({target:t})=>{t.classList.remove("flicker")},{once:!0});const Fl=()=>{js(),Ot(),nr()},Nl=()=>{me("click to continue"),fe(),window.addEventListener("click",Fl,{once:!0})};window.addEventListener("load",Nl);const uo=document.getElementById("graphicModeSwitch"),Ro=document.getElementById("gameSection");let Js="low";const Gl=()=>{nt("room2WallBug"),cc(),nt("room5FloorBug")},Vl=()=>{Js==="low"?(Ro.classList.add("low"),Gl()):Ro.classList.remove("low")},_s=t=>{Js=t,Vl()},zl=t=>{var e;(e=document.querySelector(`#graphicModeSwitch button[data-graphicmode="${t}"]`))==null||e.classList.add("selected"),_s(t)},Kl=({target:t})=>{t.classList.contains("selected")||(h.play("menuButtonClick"),uo.querySelector(".selected").classList.remove("selected"),t.classList.add("selected"),_s(t.dataset.graphicmode))},Hl=({target:t})=>{t.tagName==="BUTTON"&&ut.play("menuButtonHover")};uo.addEventListener("click",Kl);uo.addEventListener("mouseover",Hl);const jl=t=>{if(t.code==="NumpadAdd"&&t.ctrlKey||t.code==="NumpadSubtract"&&t.ctrlKey||t.code==="Space"||t.code==="Enter"){t.preventDefault();return}};window.addEventListener("keydown",jl);const Jl=t=>{t.ctrlKey&&t.preventDefault()};window.addEventListener("wheel",Jl,{passive:!1});const _l=t=>{t.preventDefault()};window.addEventListener("contextmenu",_l);const se=new V,$l=({newRealAngleX:t,newRealAngleY:e,newNormalizedAngleX:o,newNormalizedAngleY:r})=>{const d=tA(e),c=st(o),g=eA(e,d,r);Vr(t),zr(d),Kr(c),Hr(g),se.broadcast({realAngleX:t,realAngleY:d,newNormalizedAngleX:c,newNormalizedAngleY:g})},Oo=60,Zo=-60,tA=t=>t>Oo?Oo:t<Zo?Zo:t,eA=(t,e,o)=>t!==e?on():st(o);Ne.subscribe($l);const oA=({newNormalizedAngleX:t})=>{const{x:e,z:o}=Fe(st(t-180));ea(e),oa(o)};se.subscribe(oA);const nA=({newNormalizedAngleX:t})=>{const{x:e,z:o}=Fe(st(t));$r(e),ta(o)};se.subscribe(nA);const sA=({newNormalizedAngleX:t})=>{const{x:e,z:o}=Fe(st(t-90));na(e),sa(o)};se.subscribe(sA);const $s=new V,Kt=hn()/-3.75;let qt=!1;const rA=t=>{if(aA(t)){if(qt)return;lA()}else{if(!qt)return;AA()}},aA=t=>t.forward||t.backward?t.right||t.left:!1,iA=()=>{Ht(D().stepSizeX+Kt),jt(D().stepSizeZ+Kt)},cA=()=>{Ht(D().stepSizeX-Kt),jt(D().stepSizeZ-Kt)},lA=()=>{qt=!0,iA(),$s.broadcast(qt)},AA=()=>{qt=!1,cA(),$s.broadcast(qt)};kt.subscribe(rA);const dA={forward:()=>{et.startMove("forward")},backward:()=>{et.startMove("backward")},right:()=>{ot.startMove("right")},left:()=>{ot.startMove("left")}},qA={forward:"backward",backward:"forward",right:"left",left:"right"},uA=t=>{if(t[t.changed])return;const e=qA[t.changed];t[e]&&dA[e]()};kt.subscribe(uA);Is();zl("low");
